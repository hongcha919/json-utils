function e(e){const t=JSON.stringify(e);return JSON.parse(t)}function t(e,t){return JSON.stringify(e)===JSON.stringify(t)}function r(e){let t=!1;return void 0!==e&&(t=!0),t}function i(t,r,i){let a=r;if(i&&(a=e(r)),t){const e=t.split("-");for(let t=0,r=e.length;t<r;t++){const r=e[t];r&&(a=a&&a[r])}}return a}function a(t,r,i){let a=r;if(i&&(a=e(r)),t){const e=t.split("-");for(let t=0,r=e.length;t<r;t++){const r=e[t];if("0"!==r||"array"!==a.format&&"radio"!==a.format&&"select"!==a.format||!a.items){if(r){let e="0";if(a.propertyOrder)e=a.propertyOrder[r];else if(a.properties){e=Object.keys(a.properties)[r]}a=a.properties[e]}}else a=a.items}}return a}function n(e,t){let r=t,i="";const a=e.split("-");for(let e=0,t=a.length;e<t;e++){const t=a[e];if("0"===t&&r.items)r=r.items,i=i?i+"-items":"items";else if(t){let e="0";if(r.propertyOrder)e=r.propertyOrder[t];else if(r.properties){e=Object.keys(r.properties)[t]}r=r.properties[e],i=i?`${i}-${e}`:e}}return i}const o={type:"object",format:"event",title:"事件",isRequired:!1,readOnly:!1,properties:{type:{type:"string",default:"emit",format:"typeSelect",enum:["on","emit"],enumextra:["on","emit"],title:"事件类型",isRequired:!1,readOnly:!1},trigger:{type:"string",format:"input",default:"eventName",title:"触发事件",description:"用于输入触发事件的名称",placeholder:"请输入触发事件的名称",isRequired:!1,readOnly:!1},eventData:{type:"string",title:"事件数据",format:"json",default:"{}",description:"传递给触发事件的数据对象",isRequired:!1,readOnly:!1}},required:["type","trigger","eventData"],propertyOrder:["type","trigger","eventData"]},p={type:"object",format:"datasource",title:"数据源",readOnly:!1,properties:{type:{type:"string",default:"local",format:"typeSelect",enum:["local","remote"],enumextra:["local","remote"],title:"数据源类型"},data:{type:"string",title:"本地json数据",placeholder:"请输入静态json数据",format:"json",default:"{}",description:"用于设置本地的静态json数据",isRequired:!0},filter:{type:"string",title:"过滤器",format:"codearea",default:"() => {}",description:"用于定义过滤当前数据的函数",isRequired:!0}},required:["type","data","filter"],propertyOrder:["type","data","filter"]},l={type:"local",config:{dataName:"",body:{},filter:"return data;"},data:"{}",localFilter:"return data;"},s={jsonschema:{type:"object",title:"jsonSchemaObject",properties:{func:{type:"object",format:"func",title:"功能设置",readOnly:!0,properties:{a:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["a"],propertyOrder:["a"]},style:{type:"object",format:"style",title:"样式设置",readOnly:!0,properties:{b:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["b"],propertyOrder:["b"]},data:{type:"object",format:"data",title:"数据设置",readOnly:!0,properties:{c:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["c"],propertyOrder:["c"]}},required:["func","style","data"],propertyOrder:["func","style","data"]},input:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},boolean:{type:"boolean",title:"布尔值",format:"boolean",default:!1,description:"",isRequired:!1,readOnly:!1},object:{type:"object",format:"object",title:"对象类型",description:"",isRequired:!1,readOnly:!1,properties:{a:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["a"],propertyOrder:["a"]},array:{type:"array",format:"array",title:"数组",description:"",isRequired:!1,readOnly:!1,items:{type:"object",format:"object",title:"数组项",description:"",isRequired:!1,readOnly:!1,properties:{name:{type:"string",format:"input",title:"名字",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["name"],propertyOrder:["name"]}},"empty-array":{type:"array",format:"array",title:"数组",description:"",items:{type:"object",format:"object",title:"数组项",description:"",properties:{}}},"empty-object":{type:"object",format:"object",title:"对象类型",description:"",properties:{}},url:{type:"string",title:"URL",format:"url",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},textarea:{type:"string",title:"多行文本框",format:"textarea",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},color:{type:"string",title:"颜色值",format:"color",default:"#ffffff",description:"",isRequired:!1,readOnly:!1},img:{type:"string",title:"IMG",format:"image",default:"",description:"点击上传图片",imgWidth:200,imgHeight:200,imgRatio:1,imgRatioReadOnly:!1,isRequired:!1,readOnly:!1},number:{type:"number",title:"数值",format:"number",default:1,minimum:0,maximum:1e3,description:"",isRequired:!1,readOnly:!1},json:{type:"string",title:"json数据项",format:"json",default:"{}",description:"",isRequired:!1,readOnly:!1},codearea:{type:"string",title:"函数类型",format:"codearea",placeholder:"请输入函数方法",default:'function func() { console.log("hello, world!"); }',description:"用于定义函数方法",isRequired:!1,readOnly:!1},htmlarea:{type:"string",title:"富文本类型",format:"htmlarea",placeholder:"请输入html代码片段",default:"<p>hello,world!</p>",description:"用于放置html代码片段",isRequired:!1,readOnly:!1},date:{type:"string",title:"日期",format:"date",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},"date-time":{type:"string",title:"日期",format:"date-time",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},time:{type:"string",title:"时间",format:"time",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},quantity:{type:"object",format:"quantity",title:"单位计量输入",isRequired:!1,readOnly:!1,properties:{unit:{type:"number",title:"单位数值",format:"number",default:50,minimum:0,maximum:1e3,description:"",isRequired:!1,readOnly:!1},quantity:{type:"string",format:"typeSelect",default:"px",enum:["px","rem","em","%"],enumextra:["px","rem","em","%"],title:"单位类型",isRequired:!1,readOnly:!1}},required:["unit","quantity"],propertyOrder:["unit","quantity"]},radio:{type:"string",title:"单选",format:"radio",items:{type:"string",enum:["a","b","c"],enumextra:["选项a","选项b","选项c"]},description:"",isRequired:!1,readOnly:!1},select:{type:"array",title:"多选",format:"select",items:{type:"string",enum:["a","b","c"],enumextra:["选项a","选项b","选项c"]},description:"",isRequired:!1,readOnly:!1},"dynamic-data":{type:"object",format:"dynamic-data",title:"动态数据",readOnly:!1,properties:{type:{type:"string",default:"local",format:"typeSelect",enum:["local","remote"],enumextra:["本地数据","接口数据"],title:"数据类型"},config:{type:"object",title:"接口配置",format:"object",description:"用于存放接口的配置数据(url、请求参数等)",isRequired:!0,properties:{dataName:{type:"string",default:"local",format:"typeSelect",enum:["local","remote"],enumextra:["本地数据","接口数据"],title:"数据类型"},body:{type:"object",title:"请求参数配置",format:"object",description:"用于配置当前接口的请求参数数值",isRequired:!0},filter:{type:"string",title:"过滤器函数体",format:"codearea",default:"return data;",description:"用于定义过滤接口数据",isRequired:!0}},required:["dataName","body","filter"],propertyOrder:["dataName","body","filter"]},data:{type:"string",title:"数据内容",format:"json",default:"{}",description:"用于存放DynamicData的数据内容",isRequired:!0},localFilter:{type:"string",title:"过滤器",format:"codearea",default:"return data;",description:"用于定义过滤本地数据",isRequired:!0}},required:["type","config","data","localFilter"],propertyOrder:["type","config","data","localFilter"]},datasource:p,event:o},d={on:{type:"object",format:"event",title:"事件",isRequired:!1,readOnly:!1,properties:{type:{type:"string",default:"on",format:"typeSelect",enum:["on","emit"],enumextra:["on","emit"],title:"事件类型",isRequired:!1,readOnly:!1},register:{type:"string",format:"input",default:"eventName",title:"注册事件",description:"用于输入注册事件的名称",placeholder:"请输入注册事件的名称",isRequired:!1,readOnly:!1},actionFunc:{type:"string",title:"执行函数",format:"codearea",default:"() => {}",description:"",isRequired:!1,readOnly:!1}},required:["type","register","actionFunc"],propertyOrder:["type","register","actionFunc"]},emit:o},u={local:p,remote:{type:"object",format:"datasource",title:"数据源",readOnly:!1,properties:{type:{type:"string",default:"remote",format:"typeSelect",enum:["local","remote"],enumextra:["local","remote"],title:"数据源类型"},data:{type:"string",title:"远程json数据",placeholder:"请输入远程json数据源地址",format:"url",default:"http://xxx",isRequired:!0,description:"用于设置获取元素数据的请求地址"},filter:{type:"string",title:"过滤器",format:"codearea",default:"() => {}",description:"用于定义过滤当前数据的函数",isRequired:!0}},required:["type","data","filter"],propertyOrder:["type","data","filter"]}};function c(e){return/^http[s]?:\/\/.*/.test(e)}function f(e){return"String"===Object.prototype.toString.call(e).slice(8,-1)}function y(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function m(e){return"Boolean"===Object.prototype.toString.call(e).slice(8,-1)}function g(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function O(e){return/^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}$/.test(e)||/^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}$/.test(e)}function b(e){return/^\d{2}:\d{2}:\d{2}$/.test(e)||/^\d{2}:\d{2}$/.test(e)}function j(e){let t=!1;return"Array"===Object.prototype.toString.call(e).slice(8,-1)&&(t=!0),t}function q(e){if(!j(e))return!1;for(let t=0,r=e.length;t<r;t++){if(!f(e[t]))return!1}return!0}function h(e){let t=!1;return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&(t=!0),t}function R(e){let t=!1;return s.quantity.properties.quantity.enum.indexOf(e)>=0&&(t=!0),t}function x(e){return/^#[0-9a-f]{6}$/.test(e)||/^#[0-9a-f]{3}$/.test(e)}function v(e){let t=!1;return"Function"===Object.prototype.toString.call(e).slice(8,-1)&&(t=!0),t}function N(t){let r={};return r=t&&h(t)?function(t){let r;if(h(t)){const i=Object.keys(t);t.data&&t.filter&&2===i.length?r=j(t.data)||h(t.data)?e(u.local):e(u.remote):t.trigger&&t.eventData&&2===i.length?r=e(d.emit):t.register&&t.actionFunc&&2===i.length?r=e(d.on):t.quantity&&R(t.quantity)&&2===i.length?r=e(s.quantity):(r=e(s["empty-object"]),Object.keys(t).map(e=>{const i=t[e];r.properties[e]=N(i)}))}return r}(t):t&&j(t)?function(t){let r;if(t&&j(t))if(q(t)){r=e(s.select),r.items.enum=t;const i=r.items.enumextra.length,a=t.length;if(a>i)for(let e=i,n=a;e<n;e++)r.items.enumextra.push("选项"+t(e))}else{r=e(s["empty-array"]);const i=N(t[0]);r.items.properties=i.properties}return r}(t):function(t){let r="";if(m(t))r=e(s.boolean);else if(y(t))r=e(s.number);else if(c(t))r=e(s.url);else if(g(t))r=e(s.date);else if(O(t))r=e(s["date-time"]);else if(b(t))r=e(s.time);else if(x(t))r=e(s.color);else try{r=y(JSON.parse(t))?e(s.input):e(s.json)}catch(i){r=t&&t.length>30?e(s.textarea):e(s.input)}return r}(t),r}function S(e){let t=e&&e.format;return t||(t=e&&e.type?e.type:"input"),t}function F(e){let t=!0;if(!e)return t;const r=S(e);return("object"===r&&e.properties&&e.propertyOrder&&e.propertyOrder.length>0||"array"===r&&e.items&&e.items.properties&&e.items.propertyOrder&&e.items.propertyOrder.length>0||e.type||e.format)&&(t=!1),t}function k(e){let t=!0;if(e){if("object"===S(e)&&e.properties&&e.propertyOrder&&e.propertyOrder.length>0){const r=e.properties.func||{},i=e.properties.style||{},a=e.properties.data||{};(r.propertyOrder&&r.propertyOrder.length>0||i.propertyOrder&&i.propertyOrder.length>0||a.propertyOrder&&a.propertyOrder.length>0)&&(t=!1)}}return t}function $(e){let t=!1;if(e){"object"===S(e)&&e.properties&&e.propertyOrder&&e.properties.func&&e.properties.style&&e.properties.data&&(t=!0)}return t}function D(e){let t=!1;const{lastUpdateTime:r}=e,i=new Date("2020-07-29T07:30:00.691Z").getTime();return r&&new Date(r).getTime()>=i&&(t=!0),t}function J(e){let t=!1;return"func"!==e&&"style"!==e&&"data"!==e&&"object"!==e||(t=!0),t}function w(e){let t=!1;return"func"!==e&&"style"!==e&&"data"!==e||(t=!0),t}function T(e,t){const r=e.split("-"),i=t.split("-");return r.pop(),i.pop(),r.join("-")===i.join("-")}function U(e,t){const r=e.split("-"),i=t.split("-");let a="before";for(let e=0,t=(r.length>i.length?i:r).length;e<t;e+=1){Number(r[e])>Number(i[e])&&(a="after")}return a}function A(e){const t=e.split("-");return t.pop(),t.join("-")}function B(e){const t=e.split("-"),r=t.pop(),i=Number(r)+1;return t.push(""+i),t.join("-")}function G(e){const t=e.split("-"),r=t.pop();return[t.join("-"),r]}function H(e){const t=e.split("-"),r=t.pop();return t.push(Number(r)-1),t.join("-")}function I(e){const t=e.split("-"),r=t.pop();return t.push(Number(r)+1),t.join("-")}function L(e,t){let r=t||{};if(h(e)&&"object"===e.type&&e.properties){let t=[];t=e.propertyOrder?e.propertyOrder:Object.keys(e.properties),t.map(t=>{const i=e.properties[t];r=M(i,r)})}return r}function M(e,t){const r=!t;let i=t||{};if(e&&"{}"!==JSON.stringify(e)){const t=S(e);"object"===t||"func"===t||"style"===t||"data"===t?(!r&&i.object?i.object+=1:r||(i.object=1),i=L(e,i)):"array"===t?(!r&&i.array?i.array+=1:r||(i.array=1),i=L(e=e.items,i)):!r&&i[t]?i[t]+=1:r||(i[t]=1)}return i}function W(t){let i=e(t);if(!i.title&&i.description&&(i.title=i.description),i.format||(i.format=S(i)),"quantity"!==i.format&&"array"!==i.format&&"datasource"!==i.format&&"event"!==i.format&&"object"!==i.format&&"radio"!==i.format&&"select"!==i.format||!r(i.default)||delete i.default,"radio"===i.format&&(i.type="string",i.enum&&i.enumextra&&(i.items={type:"string",enum:e(i.enum),enumextra:e(i.enumextra)},delete i.enum,delete i.enumextra)),"quantity"===i.format){const t=i.properties,r=e(s.quantity);if(t.quantity&&h(t.quantity)&&t.quantity.default){const e=t.quantity.default;r.properties.quantity.default="percent"===e?"%":e}i=r}if("datasource"===i.format){const t=i.properties,r=t.type&&t.type.default,a=t.data&&t.data.default,n=t.filter&&t.filter.default;"local"===r?(i=e(u.local),i.properties.data.default=a?e(a):"{}"):(i=e(u.remote),i.properties.data.default=a?e(a):"http://xxx"),i.properties.filter.default=n?e(n):"() => {}"}if("event"===i.format){const t=i.properties,r=t.type&&t.type.default;if("in"===r||"on"===r){const r=t.filter&&t.filter.default||"() => {}";i=e(d.on),t.actionFunc&&h(t.actionFunc)&&(i.properties.actionFunc.default=t.actionFunc.default||e(r))}else{const r=t.filter&&t.filter.default||"{}";i=e(d.emit),t.eventData&&h(t.eventData)&&(i.properties.eventData.default=t.eventData.default||e(r))}}return i.properties&&(i.required=Object.keys(i.properties),i.propertyOrder||(i.propertyOrder=i.required),i.propertyOrder.map(e=>{i.properties[e]=W(i.properties[e])})),i.items&&(i.items=W(i.items)),i}function Z(e,t){let i="",a=t;r(a)&&r(e.default)&&typeof a!=typeof e.default&&(a=void 0);let n=r(a)?a:e.default;switch(e.type){case"string":if("typeSelect"===e.format)i=e.default;else if("color"===e.format)"#fff"!==n&&"#FFF"!==n||(n="#ffffff"),i=n||"#ffffff";else if("json"===e.format){let e="";if(h(t)||j(t))e=t;else if(v(t)||""===t)e={};else try{e=JSON.parse(t)}catch(t){e={}}i=e}else i=r(n)?n:"";break;case"boolean":i=!!r(n)&&n;break;case"number":i=r(n)?n:1;break;default:i=r(n)?n:""}return i}function z(t,i){let a={};const n=S(t);if(h(t)&&"object"===t.type){const o=t;let p=i;r(p)&&r(o.default)&&typeof p!=typeof o.default&&(p=void 0);const s=r(p)?p:o.default;if("dynamic-data"===n)a=e(l),s&&h(s)&&"{}"!==JSON.stringify(s)&&(a=Object.assign(a,s));else if("datasource"===n)o.properties&&o.properties.type&&o.properties.type.default&&"local"===o.properties.type.default?(a={data:"{}",filter:"() => {}"},s&&s.data&&(a.data=s.data),s&&s.filter&&(a.filter=s.filter),"http://xxx"===a.data&&(a.data="{}")):(a={data:"http://xxx",filter:"() => {}"},s&&s.data&&(a.data=s.data),s&&s.filter&&(a.filter=s.filter),"{}"===a.data&&(a.data="http://xxx"));else if("event"===n)o.properties&&o.properties.type&&o.properties.type.default&&"emit"===o.properties.type.default?s&&"out"===s.type?a={trigger:s&&s.filter||"eventName",eventData:"{}"}:(a={trigger:"eventName",eventData:"{}"},s&&s.trigger&&(a.trigger=s.trigger),s&&s.eventData&&(a.eventData=s.eventData)):s&&"in"===s.type?a={register:"eventName",actionFunc:s&&s.filter||"() => {}"}:(a={register:"eventName",actionFunc:"() => {}"},s&&s.register&&(a.register=s.register),s&&s.actionFunc&&(a.actionFunc=s.actionFunc));else if(t.properties){let e=[];e=t.propertyOrder?t.propertyOrder:Object.keys(t.properties),e.map(e=>{const r=t.properties[e],n=i&&i[e];switch(r.type){case"array":a[e]=C(r,n);break;case"object":a[e]=z(r,n);break;default:a[e]=Z(r,n)}})}}return a}function C(e,t){let i=[];if(e&&"array"===e.type){let a=t;r(a)&&r(e.default)&&typeof a!=typeof e.default&&(a=void 0);const n=r(a)?a:e.default;if("array"===e.format)if(j(n))n.map(t=>{i.push(z(e.items,t))});else{const t=z(e.items,n);i.push(t)}else i=r(n)?n:[]}return i}function E(e,t){let r={};return r="object"===e.type?z(e,t):"array"===e.type?C(e,t):Z(e,t),r}const K=s;function P(e,t){let r=t||[];if(e&&"{}"!==JSON.stringify(e))if(h(e))if(e.type&&"remote"===e.type&&e.config&&h(e.config)&&e.localFilter&&e.data){let t=e.config.body;if(t&&!h(t))try{t=JSON.parse(t)}catch(e){t={}}r.push({id:e.config.id,dataName:e.config.dataName,body:t})}else{Object.keys(e).map(t=>{P(e[t],r)})}else j(e)&&e.map(e=>{P(e,r)});return r}function Q(e,t){let r=t||"data";return e.split("-").map(e=>{r=/^\d+$/.test(e)?`${r}[${e}]`:`${r}.${e}`}),r}function V(e,t){let r=[];if(h(e)){Object.keys(e).map(i=>{const a=e[i],n=t?`${t}-${i}`:i;h(a)||j(a)?r.push({title:i,value:n,key:n,children:V(a,n)}):r.push({title:i,value:n,key:n})})}else j(e)&&e.map((e,i)=>{const a=t?`${t}-${i}`:i;h(e)||j(e)?r.push({title:i,value:a,key:a,children:V(e,a)}):r.push({title:i,value:a,key:a})});return r}function X(e){const t=e.split("-");return t.pop(),t.join("-")}function Y(e){const t=e.split("-"),r=t.pop();return[t.join("-"),r]}const _=["key","enum","enumextra","items","input","boolean","number","color","url","textarea","radio","select","date","date-time","time","json","codearea","htmlarea","quantity","dynamic-data","datasource","event","array","object"];export{u as DataSourceTypeList,d as EventTypeDataList,_ as KeyWordList,s as TypeDataList,Q as dataRoute2dataPath,P as dynamicDataAnalyzer,r as exitPropertie,U as getCurPosition,S as getCurrentFormat,i as getJsonDataByKeyRoute,B as getNextIndexRoute,A as getParentIndexRoute,G as getParentIndexRoute_CurIndex,X as getParentKeyRoute,Y as getParentKeyRoute_CurKey,a as getSchemaByIndexRoute,n as indexRoute2keyRoute,j as isArray,m as isBoolean,J as isBoxSchemaData,x as isColor,g as isDateStr,O as isDateTimeStr,F as isEmptySchema,k as isEmptyWidgetSchema,t as isEqual,w as isFirstSchemaData,v as isFunction,D as isNewSchemaData,y as isNumber,h as isObject,R as isQuantity,T as isSameParent,q as isSelect,f as isString,b as isTimeStr,c as isURL,$ as isUsedToWidgetConfig,N as json2schema,V as json2treeData,M as metaElemAnalyzer,I as moveBackward,H as moveForward,e as objClone,W as oldSchemaToNewSchema,E as schema2json,K as schemaMetaList};
